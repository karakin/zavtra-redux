<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>The game of #ZAVTRA</title>
    <style>

        * {
            margin: 0;
            padding: 0;
        }

        canvas#viewport {
            border: 1px solid black;
        }
    </style>
</head>
<body>
<div>
<canvas id="viewport">Обновите браузер</canvas>
</div>

<script src="stats.js"></script>
<script src="src\game.js"></script>
<script src="src\scene.js"></script>
<script src="src\introscene.js"></script>
<script>

    var renderStats = new Stats();
    document.body.appendChild(renderStats.domElement);
    renderStats.domElement.style.position = "absolute";
    renderStats.domElement.style.top = "0px";

    var updateStats = new Stats();
    document.body.appendChild(updateStats.domElement);
    updateStats.domElement.style.position = "absolute";
    updateStats.domElement.style.top = "48px";



    (function() {


        var hidden;
        var visibilityChange;
        if (typeof document.hidden !== "undefined") {
            hidden = "hidden";
            visibilityChange = "visibilitychange";
        } else if (typeof document.mozHidden !== "undefined") { // Firefox up to v17
            hidden = "mozHidden";
            visibilityChange = "mozvisibilitychange";
        } else if (typeof document.webkitHidden !== "undefined") { // Chrome up to v32, Android up to v4.4, Blackberry up to v10
            hidden = "webkitHidden";
            visibilityChange = "webkitvisibilitychange";
        }



        var viewportElement = document.getElementById("viewport");
        var viewportContext = viewportElement.getContext("2d");

        viewportElement.width = 1000;
        viewportElement.height = 700;




        var game = new Game(viewportContext, viewportElement.width, viewportElement.height);

        window.addEventListener( "keydown", function (event) {
            game.onEvent(event);
        }, false);

        window.addEventListener( "error", function (event) {
            game.stop();
            viewportElement.style.display = "none";
            renderStats.domElement.style.display = "none";
            updateStats.domElement.style.display = "none";

            alert( event.error.message );
        }, false);

        viewportElement.addEventListener( "mousedown", function (event) {
            game.onEvent( event );
        }, false );


        game.init();
        game.start();


        if (typeof document.addEventListener === "undefined" || typeof document[hidden] === "undefined") {
            alert("This demo requires a modern browser that supports the Page Visibility API.");
        } else {
            document.addEventListener(visibilityChange, function(){
                if( document[hidden] ) {
                    document.title = "[Paused] The game of #ZAVTRA";
                    game.stop();
                } else {
                    document.title = "The game of #ZAVTRA";
                    game.start();
                }
            }, false);
        }


    })();


</script>
</body>
</html>

